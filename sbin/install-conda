#!/usr/bin/env bash
cd "$(dirname "$0")/../"

CONDA_DIR="${HOME}/miniconda3/"

download-conda-darwin () {
    curl \
        https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-x86_64.sh \
        -o "$1"
}

download-conda-linux () {
    curl \
        https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh \
        -o "$1"
}

install-conda () {
    if ! [[ -d "${CONDA_DIR}" ]]; then
        CONDA_INSTALL="$(mktemp)"
        if [[ "$OSTYPE" == darwin* ]]; then
            download-conda-darwin "${CONDA_INSTALL}"
        elif [[ "$OSTYPE" == "linux-gnu" ]]; then
            download-conda-linux "${CONDA_INSTALL}"
        else
            exit "Cannot install Conda for $OSTYPE"
        fi
        bash "${CONDA_INSTALL}" -b -p "${CONDA_DIR}"
        rm "${CONDA_INSTALL}"
    fi
}

install-all () {
    install conda
}

install () {
    for arg in $@; do
        echo "# conda: install - ${arg}"
        "install-${arg}"
    done
}

$@
